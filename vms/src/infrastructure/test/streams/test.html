<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Teste Câmeras - VMS</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        body{background:#1a1a1a;color:#fff;padding:20px;font-family:Arial;margin:0}
        h1{margin-bottom:20px}
        .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:20px;margin-top:20px}
        .camera{background:#000;border-radius:8px;padding:10px}
        .camera h3{margin:0 0 10px 0;color:#007bff}
        video{width:100%;background:#000;border-radius:4px}
        .status{padding:5px;font-size:12px;margin-top:5px;border-radius:4px}
        .loading{background:#ff9800;color:#000}
        .playing{background:#4caf50}
        .error{background:#f44336}
    </style>
</head>
<body>
    <h1>Teste de Câmeras - VMS Municipal</h1>
    
    <div class="grid">
        <div class="camera">
            <h3>RTSP Camera (Intelbras)</h3>
            <video id="v1" controls></video>
            <div id="s1" class="status loading">Carregando...</div>
        </div>
        
        <div class="camera">
            <h3>RTMP Stream (SRS)</h3>
            <video id="v2" controls></video>
            <div id="s2" class="status loading">Carregando...</div>
        </div>
        
        <div class="camera">
            <h3>IP Camera</h3>
            <video id="v3" controls></video>
            <div id="s3" class="status loading">Carregando...</div>
        </div>
    </div>

    <script>
        const cameras = [
            {id:'v1', status:'s1', url:'/hls/camera_rtsp/index.m3u8', name:'RTSP'},
            {id:'v2', status:'s2', url:'/hls/camera_rtmp/index.m3u8', name:'RTMP'},
            {id:'v3', status:'s3', url:'/hls/camera_ip/index.m3u8', name:'IP'}
        ];

        cameras.forEach(cam => {
            const video = document.getElementById(cam.id);
            const status = document.getElementById(cam.status);
            
            if(Hls.isSupported()) {
                const hls = new Hls({lowLatencyMode:true});
                hls.loadSource(cam.url);
                hls.attachMedia(video);
                
                hls.on(Hls.Events.MANIFEST_PARSED, () => {
                    status.textContent = `${cam.name} - Conectado`;
                    status.className = 'status playing';
                    video.play();
                });
                
                hls.on(Hls.Events.ERROR, (e, data) => {
                    if(data.fatal) {
                        status.textContent = `${cam.name} - Erro: ${data.details}`;
                        status.className = 'status error';
                    }
                });
            }
        });
    </script>
</body>
</html>
